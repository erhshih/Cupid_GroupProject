<!DOCTYPE html>
<html lang="en">

<head>
    @@include('./layout/meta.html', {
    "title" : "我的喜帖_上傳圖片"
    })
    <title>我的喜帖 | 上傳相片</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.24.0/axios.min.js"></script>
    <script>
                fetch('./API/member_data.php', {})
            .then((response) => {
                return response.json();
            }).then((jsonData) => {
                console.log(jsonData)
                //console.log("JSON:" + jsonData.member_account);
                if (jsonData.result != true) {
                    alert('請先登入會員！');
                    location.href = "./login.html";                
                } else {
                    
                }
            }).catch((err) => {
                console.log('錯誤:登入', err);
            });
    </script>

</head>

<body>
    <div id="cards_upload_v">

        <aside class="cards_upload_aside">
            <form method="post" id="uploadForm" enctype="multipart/form-data">
                <div class="cards_upload_aside_prev">
                    <a href="./cards_dashboard.html">
                        <div><img src="./images/icons/left.svg" alt="left"></div>
                    </a>
                    <h2>
                        上傳相片
                    </h2>
                </div>


                <div class="cards_upload_left_box">
                    <div>
                        <h3>請上傳屬於您的照片</h3>
                        <div class="cards_upload_leftItem">
                            <div class="cards_upload_head cards_upload_active" @click="fod" id="cards_upload_head1">
                                <img :src="image1" onerror="this.src='./images/cards/upload_1.jpg'">
                                <p>喜帖封面</p>
                            </div>
                            <div class="cards_upload_head" @click="fod" id="cards_upload_head2">
                                <img :src="image2" onerror="this.src='./images/cards/upload_2.jpg'">
                                <p>婚禮資訊</p>
                            </div>
                            <div class="cards_upload_head" @click="fod" id="cards_upload_head3">
                                <img :src="image3" onerror="this.src='./images/cards/upload_3.jpg'">
                                <p>我們的故事</p>
                            </div>
                            <div class="cards_upload_head" @click="fod" id="cards_upload_head4">
                                <img :src="image4" onerror="this.src='./images/cards/upload_4.jpg'">
                                <p>出席回覆</p>
                            </div>
                        </div>
                    </div>


                    <label class="cards_upload_head_1" id="cards_upload_head_1" style="display: block;">
                        <br><br><br><br><br><br><br><br><span> + </span> <br> 上傳圖片
                        <input type="file" style="display: none;" @change="selectFile1" name="file[]" multiple>
                        <div class="cards_upload_line1"></div>
                        <div class="cards_upload_line2"></div>
                        <div class="cards_upload_line3"></div>
                        <div class="cards_upload_line4"></div>
                        <img :src="image1" onerror="this.src='./images/space.png'">
                    </label>
                    <label class="cards_upload_head_1" id="cards_upload_head_2">
                        <br><br><br><br><br><br><br><br><span> + </span> <br> 上傳圖片
                        <input type="file" style="display: none;" @change="selectFile2" name="file[]" multiple>
                        <div class="cards_upload_line1"></div>
                        <div class="cards_upload_line2"></div>
                        <div class="cards_upload_line3"></div>
                        <div class="cards_upload_line4"></div>
                        <img :src="image2" onerror="this.src='./images/space.png'">
                    </label>
                    <label class="cards_upload_head_1" id="cards_upload_head_3">
                        <br><br><br><br><br><br><br><br><span> + </span> <br> 上傳圖片
                        <input type="file" style="display: none;" @change="selectFile3" name="file[]" multiple>
                        <div class="cards_upload_line1"></div>
                        <div class="cards_upload_line2"></div>
                        <div class="cards_upload_line3"></div>
                        <div class="cards_upload_line4"></div>
                        <img :src="image3" onerror="this.src='./images/space.png'">
                    </label>
                    <label class="cards_upload_head_1" id="cards_upload_head_4">
                        <br><br><br><br><br><br><br><br><span> + </span> <br> 上傳圖片
                        <input type="file" style="display: none;" @change="selectFile4" name="file[]" multiple>
                        <div class="cards_upload_line1"></div>
                        <div class="cards_upload_line2"></div>
                        <div class="cards_upload_line3"></div>
                        <div class="cards_upload_line4"></div>
                        <img :src="image4" onerror="this.src='./images/space.png'">
                    </label>
                </div>

                <button type="button" class="cards_upload_sub btn_red" onclick="doQuery(); tets(); ha();">確定新增</button>
                <!-- <button  type="button" @click="tets">1231</button> -->
            </form>


        </aside>

        <main class="cards_upload_main">

            <div class="cards_upload_main_webcontrol">
                <img src="./images/icons/computer.svg" alt="computer">
                <img src="./images/icons/mobile.svg" alt="mobile">
            </div>

            <!-- <div class="cards_upload_TV">
            <div class="cards_upload_TV2">
                <iframe id="cards_upload_ifm" onload="changeFrameHeight()" width="100%" height="50%" src="https://tibamef2e.com/tfd104/g5/dist/cards_exports.html" frameborder="0" ></iframe>
            </div>
        </div> -->
            <div class="cards_upload_newout">
                <div class="cards_exports_titlebg">
                    <h1 class="cards_exports_title" :style="changeTopC">{{cards_info_title}}</h1>
                    <div class="cards_exports_atop">
                        <a href="#cards_exports_infotext">婚禮資訊</a>
                        <a href="#cards_exports_infotext3">我們的故事</a>
                        <a href="#cards_exports_infotext5">出席回覆</a>
                    </div>
                    <div class="cards_exports_img01">
                        <img :src="image1" onerror="this.src='./images/cards/cards_exports_01.jpg'">
                    </div>
                    <div class="cards_exports_imgbg">
                        <img :src="topicImg" alt="">
                    </div>

                </div>

                <h2 class="cards_exports_dtext">我們迫不急待地想和你分享我們特別的這一天。</h2>

                <div class="cards_exports_time">
                    <p class="cards_exports_time_01" :style="changeTopC">{{cards_info_marrydate}}</p>
                    <p class="cards_exports_time_02" :style="changeTopC">Wednesday</p>
                    <div class="cards_exports_time_03">加入google行事曆</div>
                    <p class="cards_exports_time_04">台北大直典華三樓 璀璨聽</p>

                </div>





                <div class="cards_exports_infoimg">
                    <img :src="image2" onerror="this.src='./images/cards/cards_exports_02.jpg'">
                </div>


                <h2 class="cards_exports_infotext" id="cards_exports_infotext" :style="changeTopC">婚禮資訊</h2>


                <div class="cards_exports_infooutbox">
                    <div class="cards_exports_iframeei">
                        <iframe
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3614.467687045387!2d121.54106421537914!3d25.052132843717526!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3442abe6b0446815%3A0xf006dde8c27afcc7!2z57ev6IKyVGliYU1l6ZmE6Kit5Y-w5YyX6IG36KiT5Lit5b-D!5e0!3m2!1szh-TW!2stw!4v1640197200145!5m2!1szh-TW!2stw"
                            width="490" height="320" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                    </div>


                    <div class="cards_exports_infobox">
                        <div class="cards_exports_infomap">
                            日期&時間 | Date&Time
                            <p>
                                2020/07/11 上午10:00
                            </p>
                        </div>
                        <div class="cards_exports_infomap">
                            場地｜Venue
                            <p>
                                大直典華 三樓 璀璨廳
                            </p>
                        </div>
                        <div class="cards_exports_infomap">
                            地址＆電話｜Address＆Tel
                            <p>
                                {{cards_info_local}}<br>
                                02-8502-5555
                            </p>
                        </div>
                    </div>
                </div>


                <div class="cards_exports_infoimg3">
                    <img :src="image3" onerror="this.src='./images/cards/cards_exports_03.jpg'">
                </div>

                <h2 class="cards_exports_infotext3" id="cards_exports_infotext3" :style="changeTopC">我們的故事</h2>

                <p class="cards_exports_story">
                    {{cards_info_lovestory}}
                </p>


                <h2 class="cards_exports_infotext4" :style="changeTopC">婚禮倒數</h2>

                <div class="cards_exports_ontime">
                    <div class="cards_exports_ontime1"><span>102</span>days</div>
                    <div class="cards_exports_ontime1"><span>15</span>hour</div>
                    <div class="cards_exports_ontime1"><span>48</span>min</div>
                    <div class="cards_exports_ontime1"><span>12</span>sec</div>
                </div>

                <div class="cards_exports_frombg">

                    <div class="cards_exports_infoimg4">
                        <img :src="image4" onerror="this.src='./images/cards/cards_exports_04.png'">
                    </div>


                    <h2 class="cards_exports_infotext5" id="cards_exports_infotext5" :style="changeTopC">出席回覆</h2>

                    <p class="cards_exports_formte">
                        我們懷著喜悅與感謝的心，期待能見到你!<br>
                        為方便安排座席，請於<span>2021-11-01</span>前回覆出席資訊，謝謝!

                    </p>

                    <form action="#" method="get" class="cards_exports_fromexpo">
                        <div class="cards_exports_fromQ1">
                            <p class="cards_exports_formname">你的大名</p>
                            <input type="text" placeholder="    曾俊傑" class="cards_exports_forminput">
                        </div>
                        <div class="cards_exports_fromQ1">
                            <select>
                                <option value="" selected disabled>您與新人的關係?</option>
                                <option value="新郎親友">新郎親友</option>
                                <option value="新娘親友">新娘親友</option>
                            </select>
                        </div>
                        <div class="cards_exports_fromQ1">
                            <select>
                                <option value="" selected disabled>是否能來參加我們的婚宴？</option>
                                <option value="是">是</option>
                                <option value="否">否</option>
                            </select>
                        </div>
                        <div class="cards_exports_fromQ1">
                            <select>
                                <option value="" selected disabled>攜伴人數</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                            </select>
                        </div>
                        <div class="cards_exports_fromQ1">
                            <select>
                                <option value="" selected disabled>需要為您準備素食嗎?</option>
                                <option value="是">是</option>
                                <option value="否">否</option>
                            </select>
                        </div>
                        <div class="cards_exports_fromQ1">
                            <select id="cards_exports_send" onchange="cardsendexp()">
                                <option value="0" selected disabled>您需要我們寄送紙本喜帖給您嗎？</option>
                                <option value="1">是</option>
                                <option value="2">否</option>
                            </select>
                        </div>
                        <div class="cards_exports_fromQ1" id="send_expo_1" style="display: none;">
                            <p class="cards_exports_formname">地址</p>
                            <input type="text" placeholder="  **縣市**區**路**段**巷**弄**號**樓"
                                class="cards_exports_forminput">
                        </div>
                        <div class="cards_exports_fromQ1" id="send_expo_2" style="display: none;">
                            <p class="cards_exports_formname">手機號碼</p>
                            <input type="text" placeholder="  0912345678" class="cards_exports_forminput">
                        </div>
                        <div class="cards_exports_fromQ1" id="send_expo_3" style="display: none;">
                            <p class="cards_exports_formname">E-mail</p>
                            <input type="text" placeholder="  wearecupid@gmail.com" class="cards_exports_forminput">
                        </div>
                        <div class="cards_exports_fromQ1">
                            <p class="cards_exports_formname">備註</p>
                            <input type="text" placeholder="   請留下其他您想問的問題或想說的話" class="cards_exports_forminput">
                        </div>

                        <button type="submit" class="cards_exports_submit btn_red">送出</button>
                        <span class="cards_exports_down"></span>

                    </form>

                </div>
            </div>


            <div class="cards_upload_bottom_ic">
                <a href="./cards_exports.html">
                    <div><img src="./images/icons/new_page.svg" alt="page">
                        <p>查看網站</p>
                    </div>
                </a>
                <a id="cards_dashboard_sharebtn" @click="mod(event)">
                    <div><img src="./images/icons/share.svg" alt="page">
                        <p>分享</p>
                    </div>
                </a>

            </div>
        </main>

        <!-- =======================================pop彈窗========================================= -->
        <div class="cards_popboard_blackbg" id="cards_popboard_blackbg">
            <div class="cards_popboard">

                <h2>親愛的 LIZ& MOU</h2>
                <br>
                <p>恭喜完成親手釘製的喜帖 !</p>
                <p>快把這份喜悅分享出去吧 !</p>

                <input type="text" value="Htttp://cupid.com/LIZ&MOU">
                <img class="cards_popcopybtn" src="./images/icons/copy.svg" alt="">

                <div class="cards_popshareout">
                    <div class="cards_popshareall">
                        <p>以瀏覽器開啟</p>
                        <p>點擊複製網址</p>
                        <p>以電子郵件傳送</p>
                        <p>分享到FACEBOOK</p>
                        <p>分享到INSTAGRAM</p>
                    </div>
                    <div>
                        <img src="./images/qrcode5.svg" alt="">
                    </div>
                </div>

                <div class="cards_popbtndown">
                    <a href="#" class="btn_red">回首頁</a>
                    <a href="#" class="btn_red">列印喜帖</a>
                </div>
                <div class="cards_popclose" @click="modcloser(event)"><img src="./images/icons/close.svg" alt=""></div>
            </div>
        </div>
        <!-- =======================================pop彈窗========================================= -->


    </div>


    <script>
        function doQuery() {
            $.ajax({
                method: "POST",
                url: "./API/cards_upload.php",
                data: {
                    image1_name: vm.image1_name,
                    image2_name: vm.image2_name,
                    image3_name: vm.image3_name,
                    image4_name: vm.image4_name,
                },
                dataType: "text",
                success: function (response) {
                    // tets();
                    // alert("上傳成功")
                },
                error: function (exception) {
                    alert("發生錯誤: " + exception.status);
                }
            });
        };
        function tets() {
            var formData = new FormData($('#uploadForm')[0]);
            $.ajax({
                type: 'post',
                url: "./API/cards_upload2.php",
                data: formData,
                cache: false,
                processData: false,
                contentType: false,
            }).done(function (data) {
                alert('上傳成功');
            }).error(function () {
                alert("上傳失敗");
            });
        };
        function ha() {
            alert("上傳成功")
        };
        // ===========================================================================================    
        Vue.config.devtools = true;
        function cardsendexp() {
            // console.log(cards_exports_send[cards_exports_send_index]);
            // console.log(cards_exports_send.value);
            if (cards_exports_send.value == 1) {
                let send_expo_1 = document.getElementById('send_expo_1');
                let send_expo_2 = document.getElementById('send_expo_2');
                let send_expo_3 = document.getElementById('send_expo_3');

                send_expo_1.style.display = 'block';
                send_expo_2.style.display = 'block';
                send_expo_3.style.display = 'block';
            } else if (cards_exports_send.value == 2) {
                send_expo_1.style.display = 'none';
                send_expo_2.style.display = 'none';
                send_expo_3.style.display = 'none';
            }
        }


        let vm = new Vue({
            el: '#cards_upload_v',
            data: {
                topicImg: './images/cards/cards_exports_01_00.jpg',
                topicColor: 'rgba(147, 38, 57, 1)',
                topicFont: 'Noto Serif TC", serif',
                image1: '',
                image2: '',
                image3: '',
                image4: '',
                image1_name: '',
                image2_name: '',
                image3_name: '',
                image4_name: '',

                cards_info_title: '',
                cards_info_maneng: '',
                cards_info_womaneng: '',
                cards_info_goodtalk: '',
                cards_info_local: '',
                cards_info_marrydate: '',
                cards_info_marrydateend: '',
                cards_info_lovestory: '',
            },
            computed: {
                changeTopC() {
                    return {
                        color: `${this.topicColor}`,
                        fontFamily: `${this.topicFont}`
                    }
                },
            },
            methods: {
                // doQuery() {
                // var formData = new FormData($('#uploadForm')[0]);
                // $.ajax({
                //     type: 'post',
                //     url: "./API/cards_upload.php",
                //     // data: 
                //     data:{
                //         formData,
                //         image1_name:this.image1_name,
                //         image2_name:this.image2_name,
                //         image3_name:this.image3_name,
                //         image4_name:this.image4_name,
                //     },
                //     cache: false,
                //     processData: false,
                //     contentType: false,
                // }).success(function (data) {
                //     tets();
                // }).error(function () {
                //     alert("上傳失敗");
                // });

                // $("#result").html("<img src='../Loading.gif'> ")
                //     $.ajax({
                //         method: "POST",
                //         url: "./API/cards_upload.php",
                //         data: {
                //             image1_name:this.image1_name,
                //             image2_name:this.image2_name,
                //             image3_name:this.image3_name,
                //             image4_name:this.image4_name,
                //         },
                //         dataType: "text",
                //         success: function (response) {
                //             // tets();
                //             alert("上傳成功")
                //         },
                //         error: function (exception) {
                //             alert("發生錯誤: " + exception.status);
                //         }
                //     });
                // },
                // tets(){
                //     var formData = new FormData($('#uploadForm')[0]);
                //     $.ajax({
                //         type: 'post',
                //         url: "./API/cards_upload2.php",
                //         data: formData,
                //         cache: false,
                //         processData: false,
                //         contentType: false,
                //     }).success(function (data) {
                //         alert(data);
                //     }).error(function () {
                //         alert("上傳失敗");
                //     });
                // },

                chanTopC(event) {
                    // console.log(event.target.style.backgroundColor); 
                    this.topicColor = event.target.style.backgroundColor
                },
                mod(e) {
                    document.getElementById('cards_popboard_blackbg').style.display = "block"
                },
                modcloser(event) {
                    document.getElementById('cards_popboard_blackbg').style.display = "none"
                },
                selectFile1(e) {
                    let file = e.target.files[0];
                    let readFile = new FileReader();
                    console.log(readFile);
                    this.image1_name = file.name;
                    readFile.readAsDataURL(file);
                    readFile.addEventListener('load', e =>
                        this.image1 = e.target.result
                    );
                },
                selectFile2(e) {
                    let file = e.target.files[0];
                    let readFile = new FileReader();
                    this.image2_name = file.name;
                    readFile.readAsDataURL(file);
                    readFile.addEventListener('load', e =>
                        this.image2 = e.target.result
                    );
                },
                selectFile3(e) {
                    let file = e.target.files[0];
                    let readFile = new FileReader();
                    this.image3_name = file.name;
                    readFile.readAsDataURL(file);
                    readFile.addEventListener('load', e =>
                        this.image3 = e.target.result
                    );
                },
                selectFile4(e) {
                    let file = e.target.files[0];
                    let readFile = new FileReader();
                    this.image4_name = file.name;
                    readFile.readAsDataURL(file);
                    readFile.addEventListener('load', e =>
                        this.image4 = e.target.result
                    );
                },
                fod(e) {
                    let cards_upload_head = document.getElementsByClassName('cards_upload_head')
                    let cards_upload_head_1 = document.getElementsByClassName('cards_upload_head_1')
                    for (let i = 0; i < cards_upload_head.length; i++) {
                        cards_upload_head[i].addEventListener("click", function () {
                            for (let a = 0; a < cards_upload_head_1.length; a++) {
                                cards_upload_head[a].classList.remove("cards_upload_active");
                                cards_upload_head_1[a].style.display = "none";
                            }
                            cards_upload_head[i].classList.add("cards_upload_active");
                            cards_upload_head_1[i].style.display = "block";
                        })
                    }
                },

            },
            mounted() {
                axios.get('./API/cards_info.php').then((res) => {
                    console.log(res.data);
                    this.image1 = res.data[0].cardhistory_photoupload;
                    this.image2 = res.data[0].cardhistory_photoupload2;
                    this.image3 = res.data[0].cardhistory_photoupload3;
                    this.image4 = res.data[0].cardhistory_photoupload4;
                    this.topicImg = res.data[0].cardhistory_templatename;
                    this.topicColor = res.data[0].cardhistory_templatecolor;
                    this.topicFont = res.data[0].cardhistory_fontname;

                    this.cards_info_title = res.data[0].cardhistory_title;
                    this.cards_info_maneng = res.data[0].cardhistory_manengname;
                    this.cards_info_womaneng = res.data[0].cardhistory_womanengname;
                    this.cards_info_goodtalk = res.data[0].cardhistory_greeting;
                    this.cards_info_local = res.data[0].cardhistory_location;
                    this.cards_info_marrydate = res.data[0].cardhistory_date;
                    this.cards_info_marrydateend = res.data[0].cardhistory_dateend;

                    this.cards_info_lovestory = res.data[0].cardhistory_ourstory;               
                })
            },
        })
    </script>
</body>

</html>